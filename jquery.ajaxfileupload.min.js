(function(b){b.extend({createUploadIframe:function(a,b){a="jUploadFrame"+a;if(window.ActiveXObject){var d=document.createElement('<iframe id="'+a+'" name="'+a+'" />');"boolean"===typeof b?d.src="javascript:false":"string"===typeof b&&(d.src=b)}else d=document.createElement("iframe"),d.id=a,d.name=a;d.style.position="absolute";d.style.top="-9000px";d.style.left="-9000px";document.body.appendChild(d);return d},createUploadForm:function(a,c){a="jUploadForm"+a;a=b('<form  action="" method="POST" name="'+
a+'" id="'+a+'" enctype="multipart/form-data"></form>');c=b("#"+c);c=b(c).clone();b(c).appendTo(a);b(a).css({position:"absolute",top:-9999,left:-9999}).appendTo("body");return a},addOtherRequestsToForm:function(a,c){var d=b('<input type="hidden" name="" value="" />'),f;for(f in c){name=f;value=c[f];var g=d.clone();g.attr({name:name,value:value});b(g).appendTo(a)}return a},ajaxFileUpload:function(a){function c(d){var c=document.getElementById(g);try{c.contentWindow?(e.responseText=c.contentWindow.document.body?
c.contentWindow.document.body.innerHTML:null,e.responseXML=c.contentWindow.document.XMLDocument?c.contentWindow.document.XMLDocument:c.contentWindow.document):c.contentDocument&&(e.responseText=c.contentDocument.document.body?c.contentDocument.document.body.innerHTML:null,e.responseXML=c.contentDocument.document.XMLDocument?c.contentDocument.document.XMLDocument:c.contentDocument.document)}catch(l){b.handleError(a,e,null,l)}if(e||"timeout"==d){m=!0;var h;try{if(h="timeout"!=d?"success":"error","error"!=
h){var k=b.uploadHttpData(e,a.dataType);a.success&&a.success(k,h);a.global&&b.event.trigger("ajaxSuccess",[e,a])}else b.handleError(a,e,h)}catch(l){h="error",b.handleError(a,e,h,l)}a.global&&b.event.trigger("ajaxComplete",[e,a]);a.global&&!--b.active&&b.event.trigger("ajaxStop");a.complete&&a.complete(e,h);b(c).off();try{setTimeout(function(){b(c).remove();b(f).remove()},100)}catch(l){b.handleError(a,e,null,l)}e=null}}a=b.extend({},b.ajaxSettings,a);var d=(new Date).getTime(),f=b.createUploadForm(d,
a.fileElementId);a.data&&(f=b.addOtherRequestsToForm(f,a.data));b.createUploadIframe(d,a.secureuri);var g="jUploadFrame"+d,d="jUploadForm"+d;a.global&&!b.active++&&b.event.trigger("ajaxStart");var m=!1,e={};a.global&&b.event.trigger("ajaxSend",[e,a]);0<a.timeout&&setTimeout(function(){m||c("timeout")},a.timeout);try{var k=b("#"+d).attr({action:a.url,method:"POST",target:g});k.encoding?k.encoding="multipart/form-data":k.enctype="multipart/form-data";k.submit()}catch(n){b.handleError(a,e,null,n)}window.attachEvent?
document.getElementById(g).attachEvent("onload",c):document.getElementById(g).addEventListener("load",c,!1);return{abort:function(){}}},uploadHttpData:function(a,c){var d;d="xml"!=c&&c?a.responseText:a.responseXML;if("script"==c)b.globalEval(d);else if("json"==c){d=a.responseText;a=d.indexOf(">");0<=a&&(c=d.indexOf("<",a+1),0<=c&&(d=d.substring(a+1,c)));try{d=JSON.parse(d)}catch(f){b.handleError("Response data error.",d,null,f)}}else"html"==c&&b("<div>").html(d).evalScripts();return d},handleError:function(a,
c,b,f){console&&console.error&&console.error(a,c,b,f)}})})(jQuery);